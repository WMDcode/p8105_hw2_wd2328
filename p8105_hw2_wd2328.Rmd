---
title: "Homework 2"
subtitle: "P8105 Data Science"
author: "William Donovan"
output: github_document
---

```{r message=FALSE, warning=FALSE}
library(tidyverse)
```

# Problem 1

`pols-month.csv` data-frame
```{r message=FALSE}
pols_df = read_csv("data/pols-month.csv", na = c("NA", "", " ", ".")) |>
  janitor::clean_names() |>
  separate(
    mon, 
    c("year", "month", "day"), 
    sep = "-") |>
  mutate(
    month = month(
      as.numeric(month),
      label = TRUE,
      abbr = FALSE),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem")) |>
  select(-c(prez_gop, prez_dem, day))

head(pols_df, 5)
```

`snp.csv` data-frame
```{r message=FALSE}
snp_df = read_csv("data/snp.csv", na = c("NA", "", " ", ".")) |>
  janitor::clean_names() |>
  filter(!is.na(date)) |>
  mutate(
  date = parse_date_time2(
    date, 
    orders = "mdy", 
    cutoff_2000 = 49)) |>
  separate(
    date,
    c("year", "month", "day"),
    sep = "-") |>
  mutate(
    month = month(
      as.numeric(month),
      label = TRUE,
      abbr = FALSE)) |>
  select(-day)

head(snp_df, 5)
```

`unemployment.csv` data-frame
```{r message=FALSE}
unemployment_df = read_csv("data/unemployment.csv", na = c("NA", "", " ", ".")) |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment") |>
  mutate(
    month = month(
      ym(paste(year, month)),
      label = TRUE,
      abbr = FALSE),
    year = as.character(year))

head(unemployment_df, 5)
```

Joining data-sets
```{r}
snp_pols_df = full_join(pols_df, snp_df, by = c("year", "month"))
problem1_df = full_join(snp_pols_df, unemployment_df, by = c("year", "month"))

head(problem1_df, 5)
```

These data-sets are comprised of historical political and economic data. `pols-month.csv` contains monthly data from 1947-2015 for the numbers of governors, senators, and representatives that are members of the democratic or republican party, as well as which party the president belonged to. `snp.csv` contains the historical closing prices of the S&P 500 at the beginning of each month from 1950-2015. `unemployment.csv` contains the percentage unemployment from 1948-2015.
